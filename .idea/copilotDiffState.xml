<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/bookYourRide/src/com/devlawal/booking/CarBookingDAO.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/bookYourRide/src/com/devlawal/booking/CarBookingDAO.java" />
              <option name="originalContent" value="package com.devlawal.booking;&#10;&#10;public class CarBookingDAO {&#10;&#10;    private final static CarBooking[] carBookings;&#10;&#10;    static {&#10;        carBookings = new CarBooking[10];&#10;    }&#10;&#10;    public CarBooking[] getCarBookings(){&#10;        return carBookings;&#10;    }&#10;&#10;    public void book(CarBooking carBooking){&#10;        int nextSlot = -1;&#10;&#10;        for (int i = 0; i &lt; CarBookingDAO.carBookings.length; i++){&#10;            if (CarBookingDAO.carBookings[i] == null){&#10;                nextSlot = i;&#10;                break;&#10;            }&#10;        }&#10;&#10;        if(nextSlot &gt; -1){&#10;            carBookings[nextSlot] = carBooking;&#10;            return;&#10;        }&#10;&#10;        CarBooking[] expandedCarBooking = new CarBooking[carBookings.length + 10];&#10;&#10;        for (int i = 0; i &lt; carBookings.length; i++) {&#10;            expandedCarBooking[i] = carBookings[i];&#10;           }&#10;&#10;        expandedCarBooking[carBookings.length] = carBooking;&#10;        }&#10;        public void cancelCarBooking(){&#10;&#10;        }&#10;    }&#10;" />
              <option name="updatedContent" value="package com.devlawal.booking;&#10;&#10;public class CarBookingDAO {&#10;&#10;    private static CarBooking[] carBookings;&#10;&#10;    static {&#10;        carBookings = new CarBooking[10];&#10;    }&#10;&#10;    public CarBooking[] getCarBookings(){&#10;        return carBookings;&#10;    }&#10;&#10;    public void book(CarBooking carBooking){&#10;        int nextSlot = -1;&#10;&#10;        for (int i = 0; i &lt; CarBookingDAO.carBookings.length; i++){&#10;            if (CarBookingDAO.carBookings[i] == null){&#10;                nextSlot = i;&#10;                break;&#10;            }&#10;        }&#10;&#10;        if(nextSlot &gt; -1){&#10;            carBookings[nextSlot] = carBooking;&#10;            return;&#10;        }&#10;&#10;        CarBooking[] expandedCarBooking = new CarBooking[carBookings.length + 10];&#10;&#10;        for (int i = 0; i &lt; carBookings.length; i++) {&#10;            expandedCarBooking[i] = carBookings[i];&#10;        }&#10;&#10;        // place the new booking into the first new slot&#10;        expandedCarBooking[carBookings.length] = carBooking;&#10;        // reassign the backing array so future calls use the expanded array&#10;        carBookings = expandedCarBooking;&#10;    }&#10;    public void cancelCarBooking(){&#10;&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/bookYourRide/src/com/devlawal/booking/CarBookingService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/bookYourRide/src/com/devlawal/booking/CarBookingService.java" />
              <option name="originalContent" value="package com.devlawal.booking;&#10;&#10;import com.devlawal.car.Car;&#10;import com.devlawal.car.CarService;&#10;import com.devlawal.user.User;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.UUID;&#10;&#10;public class CarBookingService {&#10;&#10;    private final CarBookingDAO carBookingDAOS;&#10;    private final CarService carService ;&#10;&#10;    public CarBookingService(CarBookingDAO carBookingDAOS, CarService carService) {&#10;        this.carBookingDAOS = carBookingDAOS;&#10;        this.carService = carService;&#10;    }&#10;&#10;    public UUID bookCars(User user, String regNumber){&#10;        Car[] availableCars = getAvailableCars();&#10;        if (availableCars.length == 0){&#10;            throw new IllegalStateException(&quot;No car Available for renting&quot;);&#10;        }&#10;        for (Car availableCar : availableCars){&#10;            if(availableCar.getRegNumber().equals(regNumber)){&#10;                Car car = carService.getCar(regNumber);&#10;                UUID bookingId = UUID.randomUUID();&#10;                carBookingDAOS.book(new CarBooking(bookingId, user, LocalDateTime.now()));&#10;                return bookingId;&#10;            }&#10;        }&#10;        throw new IllegalStateException(&quot;Already booked car with regNumber&quot;+ regNumber);&#10;    }&#10;&#10;    public Car[] getUserBookedCars(UUID useId){&#10;        CarBooking[] carBooking = carBookingDAOS.getCarBookings();&#10;&#10;        int numberOfBookingsForUser = 0;&#10;        for(CarBooking cb : carBooking){&#10;            if (cb != null || cb.getUser().getId().equals(useId)){&#10;                ++numberOfBookingsForUser;&#10;            }&#10;        }&#10;        if (numberOfBookingsForUser == 0){&#10;            return new Car[0];&#10;        }&#10;        Car[] userCar = new Car[numberOfBookingsForUser];&#10;        int counter = 0;&#10;&#10;        for(CarBooking cb : carBooking){&#10;            if(cb != null || cb.getUser().getId().equals(useId)){&#10;                userCar[counter++] = cb.getCar();&#10;            }&#10;        }&#10;        return userCar;&#10;    }&#10;&#10;    public Car[] getAvailableCars(){&#10;        return getCars(carService.getCars());&#10;    }&#10;&#10;    public Car[] getAvailableElectricCars(){&#10;        return getCars(carService.getAllElectricCars());&#10;    }&#10;&#10;&#10;    private Car[] getCars(Car[] cars){&#10;        if (cars.length == 0){&#10;            return new Car[0];&#10;        }&#10;&#10;        CarBooking[] carBookings = carBookingDAOS.getCarBookings();&#10;&#10;        if (carBookings.length == 0){&#10;            return cars;&#10;        }&#10;&#10;        int availableCarCount = 0;&#10;&#10;        for (Car car : cars){&#10;            boolean booked = false;&#10;            for (CarBooking carBooking : carBookings){&#10;                if(carBooking == null || !carBooking.getCar().equals(car)){&#10;                    continue;&#10;                }&#10;                booked = true;&#10;            }&#10;            if(!booked){&#10;                ++availableCarCount;&#10;            }&#10;        }&#10;        Car[] availableCars = new Car[availableCarCount];&#10;        int index = 0;&#10;&#10;        for (Car car: cars){&#10;            boolean booked = false;&#10;            for(CarBooking carBooking : carBookings){&#10;                if(carBooking == null || !carBooking.getCar().equals(car)){&#10;                    continue;&#10;                }&#10;                booked = true;&#10;            }&#10;            if (!booked){&#10;                availableCars[index++] = car;&#10;            }&#10;        }&#10;        return availableCars;&#10;    }&#10;&#10;&#10;    public CarBooking[] getBooking(){&#10;        CarBooking[] carBookings = carBookingDAOS.getCarBookings();&#10;&#10;        int numberOfBooking = 0;&#10;&#10;        for (CarBooking cbook : carBookings){&#10;            if (cbook != null){&#10;                ++numberOfBooking;&#10;            }&#10;        }&#10;        if (numberOfBooking == 0){&#10;            return new CarBooking[0];&#10;        }&#10;&#10;        CarBooking[] bookings = new CarBooking[numberOfBooking];&#10;        int index = 0;&#10;        for (CarBooking carBooking : carBookings){&#10;            if(carBooking != null){&#10;                bookings[index++] = carBooking;&#10;            }&#10;        }&#10;        return bookings;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.devlawal.booking;&#10;&#10;import com.devlawal.car.Car;&#10;import com.devlawal.car.CarService;&#10;import com.devlawal.user.User;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.UUID;&#10;&#10;public class CarBookingService {&#10;&#10;    private final CarBookingDAO carBookingDAOS;&#10;    private final CarService carService ;&#10;&#10;    public CarBookingService(CarBookingDAO carBookingDAOS, CarService carService) {&#10;        this.carBookingDAOS = carBookingDAOS;&#10;        this.carService = carService;&#10;    }&#10;&#10;    public UUID bookCars(User user, String regNumber){&#10;        Car[] availableCars = getAvailableCars();&#10;        if (availableCars.length == 0){&#10;            throw new IllegalStateException(&quot;No car Available for renting&quot;);&#10;        }&#10;        for (Car availableCar : availableCars){&#10;            if(availableCar.getRegNumber().equals(regNumber)){&#10;                Car car = carService.getCar(regNumber);&#10;                UUID bookingId = UUID.randomUUID();&#10;                // include the car in the booking so downstream code can access it&#10;                carBookingDAOS.book(new CarBooking(bookingId, user, car, LocalDateTime.now(), false));&#10;                return bookingId;&#10;            }&#10;        }&#10;        throw new IllegalStateException(&quot;Already booked car with regNumber&quot;+ regNumber);&#10;    }&#10;&#10;    public Car[] getUserBookedCars(UUID useId){&#10;        CarBooking[] carBooking = carBookingDAOS.getCarBookings();&#10;&#10;        int numberOfBookingsForUser = 0;&#10;        for(CarBooking cb : carBooking){&#10;            // ensure cb is not null before accessing its user&#10;            if (cb != null &amp;&amp; cb.getUser() != null &amp;&amp; cb.getUser().getId().equals(useId)){&#10;                ++numberOfBookingsForUser;&#10;            }&#10;        }&#10;        if (numberOfBookingsForUser == 0){&#10;            return new Car[0];&#10;        }&#10;        Car[] userCar = new Car[numberOfBookingsForUser];&#10;        int counter = 0;&#10;&#10;        for(CarBooking cb : carBooking){&#10;            if(cb != null &amp;&amp; cb.getUser() != null &amp;&amp; cb.getUser().getId().equals(useId)){&#10;                // be defensive: cb.getCar() may be null if booking was created incorrectly&#10;                if (cb.getCar() != null) userCar[counter++] = cb.getCar();&#10;            }&#10;        }&#10;        return userCar;&#10;    }&#10;&#10;    public Car[] getAvailableCars(){&#10;        return getCars(carService.getCars());&#10;    }&#10;&#10;    public Car[] getAvailableElectricCars(){&#10;        return getCars(carService.getAllElectricCars());&#10;    }&#10;&#10;&#10;    private Car[] getCars(Car[] cars){&#10;        if (cars.length == 0){&#10;            return new Car[0];&#10;        }&#10;&#10;        CarBooking[] carBookings = carBookingDAOS.getCarBookings();&#10;&#10;        if (carBookings.length == 0){&#10;            return cars;&#10;        }&#10;&#10;        int availableCarCount = 0;&#10;&#10;        for (Car car : cars){&#10;            boolean booked = false;&#10;            for (CarBooking carBooking : carBookings){&#10;                if(carBooking == null || carBooking.getCar() == null || !carBooking.getCar().equals(car)){&#10;                    continue;&#10;                }&#10;                booked = true;&#10;            }&#10;            if(!booked){&#10;                ++availableCarCount;&#10;            }&#10;        }&#10;        Car[] availableCars = new Car[availableCarCount];&#10;        int index = 0;&#10;&#10;        for (Car car: cars){&#10;            boolean booked = false;&#10;            for(CarBooking carBooking : carBookings){&#10;                if(carBooking == null || carBooking.getCar() == null || !carBooking.getCar().equals(car)){&#10;                    continue;&#10;                }&#10;                booked = true;&#10;            }&#10;            if (!booked){&#10;                availableCars[index++] = car;&#10;            }&#10;        }&#10;        return availableCars;&#10;    }&#10;&#10;&#10;    public CarBooking[] getBooking(){&#10;        CarBooking[] carBookings = carBookingDAOS.getCarBookings();&#10;&#10;        int numberOfBooking = 0;&#10;&#10;        for (CarBooking cbook : carBookings){&#10;            if (cbook != null){&#10;                ++numberOfBooking;&#10;            }&#10;        }&#10;        if (numberOfBooking == 0){&#10;            return new CarBooking[0];&#10;        }&#10;&#10;        CarBooking[] bookings = new CarBooking[numberOfBooking];&#10;        int index = 0;&#10;        for (CarBooking carBooking : carBookings){&#10;            if(carBooking != null){&#10;                bookings[index++] = carBooking;&#10;            }&#10;        }&#10;        return bookings;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>